# 用户管理

## 文件数据权限

一个普通文件默认权限：644
保证属主用户对文件可以编辑，保证其他用户可以读取文件内容

一个目录文件默认权限：755 保证属主用户可以对目录进行编辑，保证其他用户可以读取目录中的信息，可以进入到目录中

### 文件权限配置的结论

1、root用户对所有文件有绝对的权限，只要有了执行权限，root用户可以无敌存在

2、对于文件来说，写的权限和执行权限都需要有读权限配置

3、如果想对文件进行操作，必须对文件赋予读的权限

### 目录权限配置的结论

1、root用户对目录信息有绝对的权限

2、对于目录来说，写的权限和读的权限，都需要有执行权限配合

3、如果想对目录进行操作，必须对目录赋予执行的权限

## 特殊目录:/etc/skel

当创建用户时，创建家目录会自动参照该目录创建

### 目录内信息

~~~
.bash_logout       当系统推出登录状态会执行的命令
.bash_profile      别名和环境变量（只针对某个用户）
.bashrc            别名和环境变量
~~~

### 作用

1、目录中可以存储操作规范说明文件

2、调整命令提示符的信息

## 系统中与用户相关的文件

### /etc/passwd

记录系统用户信息文件

```
root    :x  :0  :0  :root   :/root  :/bin/bash
bin     :x  :1  :1  :bin    :/bin   :/sbin/nologin
daemon  :x  :2  :2  :daemon :/sbin  :/sbin/nologin
```

第一列：用户名 

第二列：用户密码信息

第三列：用户的UID信息

第四列：用户的gid信息

第五列：用户的注释信息

第六列：用户家目录信息

第七列：用户登录系统方式 

### /etc/shadow

系统用户的密码文件

### /etc/group

记录组用户文件

### /etc/gshadow

组用户密码信息

## 系统用户相关治理

### 创建用户命令

```shell
#创建普通用户
useradd oldboy
#创建虚拟用户
useradd oldgirl -M -s /sbin/nologin
```
#### 参数说明
```
-M          不创建家目录
-s          指定使用的shell方式
-u          指定用户的UID值信息
-g          指定用户所属的主要组信息
-G          指定用户所属的附属组信息
-c          添加指定用户注释说明信息
```

### 修改用户信息

```shell
#修改用户shell信息
usermod Alex02 -s /sbin/nologin
#修改用户UID信息
usermod ALex02 -u 3000
```
#### 参数说明
```
-s        修改用户的登录信息
-g        修改用户所属的主要组信息
-G        修改用户所属的附属组信息
-c        修改用户注释说明信息
```

### 删除用户信息

```shell
userdel -r Alex04
```
#### 参数说明
```
-r        彻底删除用户以及用户的家目录
```

## 用户属主属组设置命令

chown 修改属主和属组信息

```shell
chown oldboy.root /etc/host
```

## 用户信息查看命令

```shell
#显示用户信息
id Alex01
#显示正在登陆系统的用户信息
w
#显示近期用户或终端的登录情况
last
```

## sudo功能配置说明

```shell
#修改sudo配置文件
vim /etc/sudoers

#授权单个命令或多个命令
/usr/sbin/useradd,/usr/bin/rm
#授权单个命令目录或多个命令目录（需要排除部分特权命令）
/usr/sbin/*,!/usr/sbin/visudo
#不需要用户输入密码，可以直接sudo方式执行命令
NOPASSWD:/usr/sbin/*,!/usr/sbin/visudo,/usr/bin/*
```

## 特殊权限位设置

### setuid

设置方式

chmod u+s 文件信息

chmod 4755 文件信息

在属主权限位上多出s信息

总结：setuid权限位设置，将文件属主拥有的能力，分配给所有人

### setgid

setgid权限位设置，将文件属组拥有的能力，分配给所有人

### 粘滞位 sticky bit

作用：可以将不用用户信息放置到共享目录中，实现不同用户数据可以互相查看但是不可用互相随意修改

设置方法：

chmod o+t 目录信息

chmod 1777 目录信息











