# Bash的基本功能

## 历史命令

### 历史命令查看

history [选项] [历史命令保存文件]

选项：

-c ：清空历史命令

-w ：把缓存中的历史命令写入历史命令保存文件。如果不手动指定历史命令保存文件，则放入默认历史命令保存文件~/.bash_history

使用history命令查看的历史命令和~/.bash_history文件中保存的历史命令是不同的。那是因为当前登录操作的命令并没有直接写入~/.bash_history文件，而是保存在缓存当中的。需要等到当前用户注销之后，缓存中的命令才会写入~/.bash_history文件。

如果需要把内存中的命令直接写入~/.bash_history文件，而不是等到用户注销时再写入，就使用“-w”选项

### 历史命令的调用

- 使用上、下箭头调用以前的历史命令
- 使用"!n"重复执行第n条历史命令
- 使用"!!"重复执行上一条命令
- 使用"!字串"重复执行最后一条以该子串开头的命令
- 使用"!$"重复上一条命令的最后一个参数

## 设置别名

别名的优先级高于命令

1、查看系统中已经设置好的别名：alias

2、设置别名

alias 别名 = '原命令'

命令执行时的顺序：
- 第一顺位执行用绝对路径或相对路径执行的命令
- 第二顺位执行别名
- 第三顺位执行Bash的内部命令
- 第四顺位执行按照$PATH环境变量定义的目录查找顺序找到的第一个命令

为了将别名生效，可以把别名写入环境变量配置文件~/.Bashrc

## Bash常用快捷键
| 快捷键 | 作用 | 
| --- | --- |
| Ctrl+A | 把光标移动到命令行开头。如果输入的命令过长，想要把光标移动到命令行开头时使用 |
| Ctrl+E | 把光标移动到命令行尾 |
| Ctrl+C | 强制终止当前命令 |
| Ctrl+L | 清屏，相对于clear命令 |
| Ctrl+U | 删除或剪切光标之前的命令 |
| Ctrl+K | 删除或剪切光标之后的命令 |
| Ctrl+Y | 粘贴Ctrl+U或Ctrl+K剪切的内容 |
| Ctrl+R | 在历史命令中搜索，按下Ctrl+R之后，就会出现搜索界面，只要输入搜索内容，就会从历史命令中搜索 |
| Ctrl+D | 退出当前终端 |
| Ctrl+Z | 暂停，并放入后台 |
| Ctrl+S | 暂停屏幕输出 |
| Ctrl+Q | 恢复屏幕输出 |

## 输入输出重定向

### Bash的标准输入输出

| 设备 | 设备文件名 | 文件描述符 | 类型 | 
| --- | --- | --- | --- |
| 键盘 | /dev/stdin | 0 | 标准输入 |
| 显示器 | /dev/stdout | 1 | 标准输出 |
| 显示器 | /dev/stderr | 2 | 标准错误输出 |

### 输出重定向

<table>
    <tbody>
    <tr>
        <th>类型</th>
        <th>符号</th>
        <th>作用</th>
    </tr>
    <tr>
        <td rowspan="2">标准输出重定向</td>
        <td>命令 > 文件</td>
        <td>以覆盖的方式，把命令的正确输出输出到指定文件或设备中</td>
    </tr>
    <tr>
        <td>命令 >> 文件</td>
        <td>以追加的方式，把命令的正确输出输出到指定的文件或设备中</td>
    </tr>
    <tr>
        <td rowspan="2">标准错误输出重定向</td>
        <td>错误命令 2> 文件</td>
        <td>已覆盖的方式，把命令的错误输出输出到指定的文件或设备中</td>
    </tr>
    <tr>
        <td>错误命令 2>> 文件</td>
        <td>已追加的方式，把命令的错误输出输出到指定的文件或设备中</td>
    </tr>
    <tr>
        <td rowspan="5">正确输出和错误输出同时保持</td>
        <td>命令 > 文件 2>&1</td>
        <td>已覆盖的方式，把正确的输出和错误输出保存到同一文件中</td>
    </tr>
    <tr>
        <td>命令 >> 文件 2>&1</td>
        <td>已追加的方式，把正确的输出和错误输出保存到同一文件中</td>
    </tr>
    <tr>
        <td>命令 &> 文件 </td>
        <td>已覆盖的方式，把正确的输出和错误输出保存到同一文件中</td>
    </tr>
    <tr>
        <td>命令 &>> 文件 </td>
        <td>已追加的方式，把正确的输出和错误输出保存到同一文件中</td>
    </tr>
    <tr>
        <td>命令 >> 文件1 2>>文件2 </td>
        <td>把正确的输出保存到文件1中，错误输出保存到文件2中</td>
    </tr>
    </tbody>
</table>

### 输入重定向

wc [选项] [文件名]

选项：

-c ：统计字节数

-w ：统计单词数

-l ：统计行数

## 多命令顺序执行

<table>
    <tbody>
    <tr>
        <th>多命令执行符</th>
        <th>格式</th>
        <th>作用</th>
    </tr>
    <tr>
        <td rowspan="1" align="center">;</td>
        <td align="center">命令1;命令2</td>
        <td align="center">多个命令顺序执行，命令之间没有任何的逻辑联系</td>
    </tr>
    <tr>
        <td align="center">&&</td>
        <td align="center">命令1 && 命令2</td>
        <td align="center">当命令1正确执行，则命令2才会执行<br/>当命令1执行不正确，则命令2不会执行</td>
    </tr>
    <tr>
        <td align="center">||</td>
        <td align="center">命令1 || 命令2</td>
        <td align="center">当命令1执行不正确，则命令2才会执行<br/>当命令1执行正确，则命令2不会执行</td>
    </tr>
    </tbody>
</table>

## 管道符

### 行提取命令grep

grep [选项] "搜索内容" 文件名

选项：

-A 数字 ：列出符合条件的行，并列出后续的n行

-B 数字 ：列出符合条件的行，并列出前面的n行

-i ：忽略大小写

-c ：统计找到的符合条件的字符串的次数

-n ：输出行号

-v ：反向查找

-color=auto ：搜索出的关键字用颜色表示

### find和grep的区别

find命令是在系统当中搜索符合条件的文件名，如果需要模糊查询，使用通配符进行匹配，搜索时文件名是完全匹配的
```
find命令是可以通过-regex选项识别正则表达式规则的，也就是说find命令可以按照正则表达式规则匹配，而正则表达式是模糊匹配。
```

grep命令是在文件当中搜索符合条件的字符串，如果需要模糊查询，使用正则表达式进行匹配，搜索时字符串是包含匹配

## 通配符

| 通配符 | 作    用 | 
| --- | --- |
| ? | 匹配任意一个字符 |
| * | 匹配0个或者任意多个任意字符，也就是可以匹配任何内容 |
| [] | 匹配中括号中任意一个字符。例如[abc]代表一定匹配一个字符，或者是a,b,c |
| [-] | 匹配中括号中任意一个字符，-代表的是一个范围。例如[a-z]代表匹配一个小写字母 |
| [^] | 逻辑非，表示匹配不是中括号内的一个字符。例如[^0-9]代表匹配一个不是数字的字符 |

## Bash中其他的特殊符号

| 符号 | 作    用 | 
| --- | --- |
| '' | 单引号。在单引号中所有的特殊符号，如"$","`"（反引号）都没有特殊含义 |
| "" | 双引号。在双引号中特殊符号都没有特殊含义，但是"$","`"和"\" 是例外，拥有“调用变量的值”、“引用命令”和“转义符”的特殊含义。 |
| `` | 反引号。反引号括起来的内容是系统命令，在Bash中会先执行它。和$()作用一样 |
| $() | 和反引号作用一样，用来引用系统命令 |
| () | 用于一串命令执行时，()中的命令会在子shell中执行 |
| {} | 用于一串命令执行时，{}中的命令会在当前shell中执行。也可以用于变量变形与替换 |
| [] | 用于变量的测试 |
| # | 在Shell脚本中，#开头的行表示注释 |
| $ | 用于调用变量的值，如需要调用变量name的值时，需要调用$name的方式得到变量的值 |
| \ | 转义符，在\之后的特殊符号将失去特殊含义，变为普通字符 |

### ()、{}的区别

- ()执行一串命令时，需要重新开一个子shell进行执行
- {}执行一串命令时，是在当前shell中执行
- ()和{}都是把一串的命令放在括号里面，并且命令之间用;号隔开
- ()最后一个命令可以不用分号
- {}最后一个命令要用分号
- {}的第一个命令和左括号之间必须要有一个空格
- ()里的各命令不必和括号有空格
- ()和{}中括号里面的某个命令的重定向只影响该命令，但括号外的重定向则影响到括号里面的所有命令







