# 网络通信原理

## 网络基础硬件

### 交换机

交换机：在一个网络中实现多台主机之间的通讯

一台交换机所连接的所有主机构成网络，称之为局域网

#### 实现通讯

1、主机上要有相应的MAC地址，MAC地址（物理地址）由12位16进制数组成

2、利用交换机进行通讯，有时需要借助广播方式进行通讯。广播的产生有时会影响主机的性能

#### 补充

1、网络通讯的过程必须是有来有回的

### 路由器

路由器：实现不同局域网主机中间的通讯

#### 实现通讯

1、主机上要有相应的IP地址

2、需要借助路由器中的路由表实现通讯

#### 路由表的信息信息生成

1、利用直连网络自动生成

2、利用手工配置方式（静态路由配置）

3、利用路由协议动态生成（动态路由配置）

#### 网关

网关：一个主机想访问其他网络主机的必经之路

## 网络架构设计方法（网络拓扑）

### 三个层次规划网络拓扑

核心层：路由器（网关接口） 实现和外网通讯，需要有冗余能力

汇聚层：交换机（三层交换机） 需要有冗余能力，策略控制能力

接入层：交换机（二层交换机） 实现终端设备接入网络

## 网络协议TCP-UDP

### TCP

传输控制协议

面向连接的网络协议

优点：数据传输可靠性高

缺点：数据传输效率低

### UDP

用户报文协议

无连接的网络协议

优点：数据传输效率高

缺点：数据传输可靠性低

## TCP协议三次握手过程

第一次：

发送syn请求建立连接的控制字段，发送seq序列号信息（seq=x），第一个数据包的序列号默认为0

第二次：

发送syn请求建立连接控制终端，同时还会发送ack确认控制字段

发送seq序列号信息（seq=y），还会发送ACK确认号（seq=x+1）信息，对上一个数据序列号信息进行确认

第三次：

发送ACK确认控制字段，发送seq序列号信息（seq=x+1），发送ack确认号（ack=y+1）

## TCP协议四次挥手过程

第一次：
发送FIN请求断开连接控制字段

第二次：
发送ACK确认控制字段

第三次： 
发送FIN请求断开连接字段，发送ACK确认字段

第四次：
发送ACK控制字段

## TCP的十一种状态集

TCP三次握手：
~~~
1、最开始两台主机都处于关闭状态    closed
2、服务端将相应服务进行开启        closed --- listen
3、客户端向服务器端发出连接请求    closed --- syn_sent
4、服务端接收到连接请求，进行确认   listen --- syn_rcvd
5、客户端再次进行确认              syn_sent --- established
6、服务端接收到确认信息            syn_rcvd --- established
~~~
TCP四次挥手： 
~~~
1、客户端发送请求断开连接信息 established --- fin_wait1
2、服务端接收断开连接请求，并进行确认 established --- close_wait
3、客户端接收到了请求信息   fin_wait1 --- fin_wait2
4、服务端发送ack和fin字段    close_wait -- last_ack
5、服务端接收到请求断开连接信息，发送确认    fin_wait2 --- time_wait
6、服务端接收到确认信息    last_ack --- closed
7、客户端等待一段时间     time_wait --- closed
~~~



